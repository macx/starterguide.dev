---
title: Probleme beheben
description: Hier findest du Lösungen für häufige Probleme bei der Installation und Nutzung von Node.js und npm.
---

import Lead from '@components/Lead.astro'
import { Tabs, TabItem, Steps, Aside } from '@astrojs/starlight/components'

<Lead>
  Bei der Node.js-Installation treten je nach System leicht Probleme auf. Hier
  siehst du, wie du häufige Fehler schnell behebst.
</Lead>

Fehler können viele Ursachen haben: fehlende Berechtigungen, blockierte Ports, inkompatible Versionen oder fehlende System-Tools. Alles Dinge, die außerhalb deiner Kontrolle liegen können. Aber keine Sorge – die meisten Probleme lassen sich mit ein paar Handgriffen lösen.

## Häufige Fehler

Hier findest du die Fehler, die am häufigsten auftreten, sortiert nach Wahrscheinlichkeit.

### Berechtigungen & Skripte

Oft scheitert es schon ganz am Anfang: Du darfst keine Skripte ausführen oder hast keine Schreibrechte.

<Tabs>
  <TabItem label="macOS">
    **Fehlende Rechte (EACCES)**

    Wenn Node.js oder npm mit `sudo` installiert wurden oder wenn die Standard-Verzeichnisse für globale Pakete nicht dem aktuellen Benutzer gehören, kommt es zu Problemen bei der Rechtevergabe. So kannst du das beheben:

    ```shell
    sudo chown -R \$(whoami) \$(npm config get prefix)/{lib/node_modules,bin,share}
    ```

  </TabItem>

  <TabItem label="Windows">
    **Skripte können nicht ausgeführt werden**

    Windows blockiert standardmäßig das Ausführen von Skripten in der PowerShell. Das sieht dann etwas so aus:

    ![](/src/assets/npm-error.png)

    Um das zu ändern, öffne die PowerShell als Administrator und führe den folgenden Befehl aus:

    ```shell
    Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
    ```

    Schließe anschließend die PowerShell und öffne sie erneut.

  </TabItem>
</Tabs>

### Port bereits belegt (`EADDRINUSE`)

Wenn du versuchst, deinen Entwicklungsserver zu starten (z. B. mit `npm start` oder `npm run dev`), und eine Fehlermeldung mit `EADDRINUSE` erhältst, bedeutet das, dass der Port bereits von einem anderen Programm verwendet wird. Ein Port steht für eine bestimmte Netzwerkverbindung und kann nur von einem Programm gleichzeitig genutzt werden.

Im folgenden verwenden wir beispielhaft den Port `3000`. Ersetze ihn durch den Port, der in deiner Fehlermeldung angegeben ist.

<Steps>

1.  Schließe andere Terminal-Fenster, in denen vielleicht noch ein Entwicklungsserver läuft.

2.  Beende den blockierenden Prozess:

    ```shell
    npx kill-port 3000
    ```

3.  Funktioniert das nicht, finde die Prozess-ID (PID) und beende den blockierenden Prozess manuell:

        <Tabs>
          <TabItem label='macOS'>

            ```shell
            lsof -i :3000
            kill -9 <PID>
            ```

          </TabItem>

          <TabItem label='Windows'>

            ```shell
            netstat -ano | findstr :3000
            taskkill /PID <PID> /F
            ```

          </TabItem>

    </Tabs>

</Steps>

### Abhängigkeitskonflikte (`ERESOLVE`)

Manchmal können sich verschiedene Pakete nicht auf eine gemeinsame Version einer Abhängigkeit einigen. Du siehst dann einen Fehler, der mit `ERESOLVE unable to resolve dependency tree` beginnt.

Versuche, die Abhängigkeiten mit dem Flag `--legacy-peer-deps` zu installieren:

```shell
npm install --legacy-peer-deps
```

Wenn das nicht hilft, überprüfe die `package.json`-Datei auf widersprüchliche Versionsangaben und passe sie gegebenenfalls an.

## Kompilierungsfehler (`gyp ERR` und `node-gyp`)

Unter macOS kann die Installation von npm-Paketen fehlschlagen und zu roten Fehlermeldungen führen, die `gyp ERR!` oder `node-gyp` enthalten. Hier kann es mehrere Ursachen und Auswirkungen geben.

Oft liegt es daran, dass auf einem System die notwendigen Build-Tools, sogenannte „Compiler“, die in C oder C++ geschrieben sind, fehlen.

### Command Line Tools

Fehlende Compiler können mit den Xcode Command Line Tools nachinstalliert werden. Diese kannst du mit folgendem Befehl installieren:

```shell
xcode-select --install
```

Schlägt das fehlt, installiere dir die Command Line Tools manuell:

<Steps>

1. Gehe auf [Apple Developer Downloads](https://developer.apple.com/download/all/?q=Command%20Line%20Tools).

2. Melde dich mit deiner Apple-ID an, die du auch im AppStore verwendest.

3. Suche nach „Command Line Tools" passend zu deiner macOS-Version und installiere sie.

</Steps>

Falls hier weiterhin Fehler auftreten, kann es helfen, die fehlerhafte Installation von den Command Line Tools zu entfernen und neu zu installieren. Folge dafür der Anleitung [Reset your Xcode Install on macOS](https://gist.github.com/Justintime50/2349ff5e62555aa097acbf519bbc27af)

### Fehler im integrierten Terminal

Ein frustrierendes, aber bekanntes Phänomen: Du hast die Command Line Tools installiert und im normalen Terminal funktioniert `npm install` problemlos. Doch im integrierten Terminal von VS Code hagelt es immer noch rote Fehlermeldungen (oft `node-gyp` oder `gyp ERR`).

Auch das kann mehrere Ursachen haben. Die gebräuchlichsten hier sind:

#### 1. Falsche Shell (`bash` statt `zsh`)

Wenn du Node.js mit Homebrew installiert hast, nutzt du wahrscheinlich die `zsh`-Shell -- seit macOS Catalina (10.15) ist das die Standardshell. Dort sind die Pfade für Node.js schon vorkonfiguriert, sodass der Aufruf von `npm install` auch funktioniert.

Das integrierte Terminal von VS Code verwendet jedoch standardmäßig `bash` als Shell. VS Code können wir aber so einstellen, dass es `zsh` nutzt.

<Steps>

1. Öffne die Befehlspalette (<kbd>⌘ Command</kbd> + <kbd>⇧ Shift</kbd> + <kbd>P</kbd>).

2. Suche nach `Terminal: Select Default Profile`.

3. Wähle **zsh** aus.

4. Wenn du schon ein Terminal geöffnet hast, öffne mit einem Klick auf das `+`-Symbol ein `zsh`-Terminal. Schließe dann mit einem Klick auf das Mülltonnen-Symbol das alte `bash`-Terminal.

   ![VS Code Terminal Profile Selection](/src/assets/vscode-terminal-and-zsh.png)

</Steps>

#### 2. Fehlende Pfade

Einee weitere Fehlerquelle sind fehlende Pfade zu wichtigen Tools wie Python. Python ist eine Voraussetzung für `node-gyp`, da es Teile des Codes in C++ kompiliert. Was im Hintergrund da genau passiert, ist jetzt nicht relevant. Wichtig ist nur, dass wir dafür sorgen, dass `node-gyp` Python auch findet. Das machen wir über die sogenannten Umgebungsvariablen (`PATH`).

Gebe im Terminal folgenden Befehl ein, um zu überprüfen, ob der Pfad gesetzt ist.

```shell
which python3
```

Wenn da kein Ergebnis kommt, fehlt der Pfad. Den kannst du so setzen:

<Steps>

1. Öffne in VS Code die Einstellungen (`Cmd + ,`).

2. Suche nach `terminal.integrated.inheritEnv` und aktiviere es.

</Steps>

#### 4. Rosetta-Modus

Auf Mac mit Apple Silicon (M1, M2, M3, M4 usw.) kann es passieren, dass VS Code im „Rosetta-Modus" (für Intel-Chips) läuft, während dein System und Node.js nativ auf `arm64` laufen. Dieser Architektur-Mix führt zu Fehlern beim Kompilieren.

Prüfe im Terminal durch die Eingabe von `arch`, ob VS Code im falschen Modus läuft. Erscheint `i386`, musst du die Einstellung ändern:

<Steps>

1. Beende VS Code vollständig.

2. Öffne den Finder und gehe zu „Programme".

3. Rechtsklick auf „Visual Studio Code" > „Informationen".

4. Entferne den Haken bei **„Mit Rosetta öffnen"**.

</Steps>

<Aside title='Workaround'>
  Falls es schnell gehen muss: Führe `npm install` einfach im normalen
  Mac-Terminal aus. Sobald die Installation fertig ist, kannst du in VS Code wie
  gewohnt weiterarbeiten.
</Aside>

## Probleme mit dem Starterkit

Fehler im Zusammenhang mit dem [Starterkit](/starterkit/intro) haben ihre Ursache in den meisten Fällen durch einen fehlerhaften Umgang.

### Fehler mit Prettier (`SyntaxError`)

Wenn du in VS Code das Profil [HAWK GT1191](https://hawk-gt1191.de/tutorials/website-mit-visual-studio-code#plugins-und-konfiguration) nutzt, ist dort Prettier vorkonfiguriert. Prettier ist ein Code-Formatter, der deinen Code automatisch formatiert, damit er einheitlich aussieht.

Das kann aber fehlschlagen, wenn sich in deinen HTML- und CSS-Dateien Fehler eingeschlichen haben. Prettier ist dann nicht in der Lage, die Dateien zu formatieren, was zu `SyntaxError`-Meldungen führt. Das erkennst du meist am roten Prettier-Button in der Statusleiste von VS Code unten rechts.

![](/src/assets/vscode-prettier.png)

Mit einem Klick auf den Button kannst du dir die genauen Fehler anzeigen lassen. Alernativ solltest du dir die Fehlermeldungen im „Problems“-Tab (`Cmd + Shift + M`) anschauen.

### Fehler beim Anlegen einer Kopie

Wenn du dir eine Vorlage oder ein Beispielprojekt kopierst, um daran zu arbeiten, kann es zu Problemen kommen, wenn du mehr kopierst als nötig. Wichtig für dich sind lediglich die Quelldateien im Verzeichnis `src` und die Datei `package.json`.

Die Verzeichnisse `node_modules` und `.parcel-cache`, sowie die Datei `package-lock.json` solltest du löschen. Danach kannst du die Abhängigkeiten mit `nom install` wieder neu installieren. Das sollte das Problem beheben.
